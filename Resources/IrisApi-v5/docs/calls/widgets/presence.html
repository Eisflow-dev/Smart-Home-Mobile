<!DOCTYPE html>
<html>
  
<!-- Mirrored from api.irissmarttest.com/v5/docs/calls/widgets/presence by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 18 Feb 2014 21:37:15 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <base  />
    <link rel="stylesheet" type="text/css" href="../../css.css" />
    <title>AlertMe.com API v5 Documentation :: calls/widgets/presence :: DRAFT</title>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
  </head>
  <body>
    <h1>
      API v5 Documentation <span>draft</span>
    </h1>
    <div class="menu">
      <ul class="menu">
   <li><h4><a href="../../../docs.html">overview</a></h4>
      <ul>
         <li><a href="../../responses.html">responses</a></li>
         <li><a href="../../errors.html">errors</a></li>
         <li><a href="../../examples.html">examples</a></li>

      </ul>
   </li>
   <li><h4>calls</h4>
      <ul>

         <li><a href="../sessions.html">sessions</a></li>

         <li><a href="../users.html">users</a>
            <ul>

               <li><a href="../users/systemalerts.html">system alerts</a></li>

               <li><a href="../questions.html">questions</a></li>

               <li><a href="../hubs.html">hubs</a>
                  <ul>
                     <li><a href="../hubs/activityLog.html">activity log (history)</a></li>
                     <li><a href="../devices.html">devices</a>
                       <ul>

                           <li><a href="../devices/events.html">events</a></li>

                        </ul>
                     </li>
                     <li><a href="../hubs/profiles.html">profiles</a></li>

                     <li>rules
                        <ul>
                           <li><a href="../rules/actions.html">actions</a></li>
                           <li><a href="../../actions.html">action types</a></li>                           
                           <li><a href="../rules/wizard.html">wizard</a></li>
                        </ul>
                     </li>
                     <li><a href="../services.html">services</a>
                        <ul>

                           <li><a href="../services/events.html">events</a></li>

                        </ul>
                     </li>

                  </ul>
               </li>

               <li><a href="../widgets.html">widgets</a>
                  <ul>
                     <li><a href="alarm.html">alarm</a></li>
                     <li><a href="care.html">care</a></li>
                     <li><a href="cameras.html">cameras</a></li>
                     <li><a href="climate.html">climate</a></li>
                     <li><a href="dashboard.html">dashboard</a></li>
                     <li><a href="heating.html">heating</a></li>
                     <li><a href="locks.html">locks</a></li>
                     <li><a href="homestatus.html">homestatus</a></li>

                     <li><a href="presence.html">presence</a></li>
                     <li><a href="smartplugs.html">smartplugs</a></li>
                     <li><a href="swingometer.html">swingometer</a></li>
                     <li><a href="temperature.html">temperature</a></li>
                     <li><a href="usage.html">usage</a></li>
                     <li><a href="petdoors.html">petdoors</a></li>
                     <li><a href="group.html">groups</a></li>
                     <li><a href="history.html">history</a></li>
                     <li><a href="irrigation.html">irrigation</a></li>
                     <li><a href="secondaryuser.html">secondaryuser</a></li>
                  </ul>
               </li>
            </ul>
         </li>
      </ul>
   </li>
</ul>
    </div>
    <div class="doc calls widgets presence_page">
      <div class="section">
    <p>
        All calls listed below follow
        <span class="call">/users/<em>:userId</em>/widgets</span>
        in the URI;
        this prefix has been omitted for conciseness
    </p>
</div>

<div class="section">
    <h2>GET <span class="call">/presence</span></h2>

    <p>Returns list of keyfobs for current user with names and dates/times of last location's state changing.</p>

    <p class="note"><em>state</em> can be <em>HOME</em>, <em>AWAY</em> or <em>UNKNOWN</em></p>

    <p class="note"><em>:lastChangedAt</em> can be formatted date, <em>NEVER</em>, <em>NEVER_IN_MONTH</em> or <em>UNKNOWN</em></p>

    <div class="sample">
        <h3>Sample Response:</h3>

        <p class="json">
{
    "keyfobsCount"      : 6,
    "keyfobs"           : [
                                {
                                    "id"            : "03-45-25-14-11-95",
                                    "name"          : "Ali",
                                    "location"      : "HOME",
                                    "lastChangedAt" : "2011-02-03 12:45"
                                },
                                {
                                    "id"            : "03-45-25-14-11-96",
                                    "name"          : "DAVID",
                                    "location"      : "AWAY",
                                    "lastChangedAt" : "2011-02-03 10:45"
                                },
                                {
                                    "id"            : "03-45-25-14-11-95",
                                    "name"          : "jon",
                                    "location"      : "AWAY",
                                    "lastChangedAt" : "2011-02-03 10:45"
                                },
                                {
                                    "id"            : "03-45-25-14-11-96",
                                    "name"          : "MIKE",
                                    "location"      : "HOME",
                                    "lastChangedAt" : "2011-02-03 12:45"
                                },
                                {
                                    "id"            : "03-45-25-14-11-96",
                                    "name"          : "Paul",
                                    "location"      : "AWAY",
                                    "lastChangedAt" : "2011-02-03 10:45"
                                },
                                {
                                    "id"            : "03-45-25-14-11-96",
                                    "name"          : "Sue",
                                    "location"      : "HOME",
                                    "lastChangedAt" : "2011-02-03 12:45"
                                }
                          ],
    "lastKeyfobAtHome"  : {
                                "id"             : "03-45-25-14-11-96",
                                "name"           : "DAVID",
                                "lastChangedAt"  : "2011-02-03 12:45"
                          },
    "widgetStatus":"OK",
    "widgetVisible":true
}
        </p>
    </div>

    <div class="args">
        <h3>Possible lastKeyfobAtHome</h3>
        <dl class="wide">
            <dt>Object</dt>
            <dd>As in sample response</dd>
            <dt>NULL</dt>
            <dd>Previously "--" string was expected here</dd>
        </dl>
    </div>

    <div class="args">
        <h3>Possible widgetStatuses</h3>
        <dl class="wide">
            <dt>OK</dt>
            <dd>Widget able to prepare all data</dd>
            <dt>NOT_AVAILABLE</dt>
            <dd>Widget is not available due user's subscription</dd>
            <dt>NO_DEVICE</dt>
            <dd>No device assigned to this widget</dd>
            <dt>DEVICE_MISSING</dt>
            <dd>Assigned devices are missing</dd>
            <dt>NO_DATA</dt>
            <dd>Inner error, data cannot be prepared correctly</dd>
        </dl>
    </div>

</div>

<div class="section">
    <h2>GET <span class="call">/presence/detail</span></h2>

    <p>Returns detailed list of keyfobs for <span><em>period</em></span>.</p>

    <p class="note"><em>location</em> can be <em>HOME</em>, <em>AWAY</em> or <em>UNKNOWN</em></p>

    <div class="args">
        <h3>Arguments:</h3>
        <dl>
            <dt>period</dt>
            <dd>one of thisWeek, thisMonth or custom</dd>
            <dt>year_from</dt>
            <dd>is a full numeric representation of a year, 4 digits. Should be presented when the period argument is
                custom
            </dd>
            <dt>month_from</dt>
            <dd>is a numeric representation of a month, 1 or 2 digits. Should be presented when the period argument is
                custom
            </dd>
            <dt>day_from</dt>
            <dd>is a day of the day, 1 or 2 digits. Should be presented when the period argument is custom</dd>
            <dt>year_to</dt>
            <dd>is a full numeric representation of a year, 4 digits. Should be presented when the period argument is
                custom
            </dd>
            <dt>month_to</dt>
            <dd>is a numeric representation of a month, 1 or 2 digits. Should be presented when the period argument is
                custom
            </dd>
            <dt>day_to</dt>
            <dd>is a day of the day, 1 or 2 digits. Should be presented when the period argument is custom</dd>
        </dl>
    </div>

    <div class="sample">
        <h3>Sample Response:</h3>

        <p class="json">
{
    "period"        : "thisWeek",
    "keyfobsCount"  : 6,
    "keyfobs" : [
                    {
                        "id"                 : "03-45-25-14-11-96",
                        "name"               : "Ali",
                        "locationProportion" : {
                                                    "HOME"    : 0.25,
                                                    "AWAY"    : 0.5,
                                                    "UNKNOWN" : 0.25
                                               }
                    },
                    {
                        "id"                 : "03-45-25-14-11-96",
                        "name"               : "DAVID",
                        "locationProportion" : {
                                                    "HOME"    : 0.25,
                                                    "AWAY"    : 0.5,
                                                    "UNKNOWN" : 0.25
                                               }
                    },
                    {
                        "id"                 : "03-45-25-14-11-96",
                        "name"               : "jon",
                        "locationProportion" : {
                                                    "HOME"    : 0.25,
                                                    "AWAY"    : 0.5,
                                                    "UNKNOWN" : 0.25
                                               }
                    },
                    {
                        "id"                 : "03-45-25-14-11-96",
                        "name"               : "MIKE",
                        "locationProportion" : {
                                                    "HOME"    : 0.25,
                                                    "AWAY"    : 0.5,
                                                    "UNKNOWN" : 0.25
                                               }
                    },
                    {
                        "id"                 : "03-45-25-14-11-96",
                        "name"               : "Paul",
                        "locationProportion" : {
                                                    "HOME"    : 0.25,
                                                    "AWAY"    : 0.5,
                                                    "UNKNOWN" : 0.25
                                               }
                    },
                    {
                        "id"                 : "03-45-25-14-11-96",
                        "name"               : "Sue",
                        "locationProportion" : {
                                                    "HOME"    : 0.25,
                                                    "AWAY"    : 0.5,
                                                    "UNKNOWN" : 0.25
                                               }
                    }
                ]
}
        </p>
    </div>
    <div class="errors">
            <h3>Returned errors:</h3>
            <dl>
                <dt>400 MISSING_PARAMETER</dt>  <dd>One of :year_from, :month_from, :day_from, :year_to, :month_to, :day_to is missing from request</dd>
                <dt>400 INVALID_PARAMETER</dt>  <dd>One of :year_from, :month_from, :day_from, :year_to, :month_to, :day_to is invalid</dd>
                <dt>404 NO_DATA</dt>  <dd>There was no stored data to return in the request period specified.</dd>
            </dl>
    </div>
</div>

<div class="section">
    <h2>GET <span class="call">/presence/detail/timeline</span></h2>

    <p>Returns detailed timeline information about all key fobs for 24 hours</p>

    <p class="note"><em>location</em> can be <em>HOME</em>, <em>AWAY</em> or <em>UNKNOWN</em></p>

    <div class="args">
        <h3>Arguments:</h3>
        <dl>
            <dt>year</dt>
            <dd>is a full numeric representation of a year, 4 digits.</dd>
            <dt>month</dt>
            <dd>is a numeric representation of a month, 1 or 2 digits.</dd>
            <dt>day</dt>
            <dd>is a day of the day, 1 or 2 digits.</dd>
        </dl>
    </div>

<div class="sample">
        <h3>Sample Response:</h3>

        <p class="json">

{
    "keyfobsCount"      : 6,      
    "keyfobs"           : [
                {
                    "id"       : "03-45-25-14-11-96",
                    "name"     : "Ali",
                    "timeline" : [
                                    { "location" : "HOME", "from" : "2011-02-01 00:00", "to" : "2011-02-01 23:59" }
                                 ]
                },
                {
                    "id"       : "03-45-25-14-11-96",
                    "name"     : "DAVID",
                    "timeline" : [
                                    { "location" : "HOME",    "from" : "2011-02-01 10:45", "to" : "2011-02-01 12:45" },
                                    { "location" : "AWAY",    "from" : "2011-02-01 12:45", "to" : "2011-02-01 15:45" },
                                    { "location" : "UNKNOWN", "from" : "2011-02-01 15:45", "to" : "2011-02-01 16:45" },
                                    ...,
                                    { "location" : "HOME", "from" : "2011-02-01 18:45", "to" : "2011-02-01 22:45" },
                                    { "location" : "AWAY", "from" : "2011-02-01 23:00", "to" : "2011-02-01 23:30" }
                                 ]
                },
                {
                    "id"       : "03-45-25-14-11-96",
                    "name"     : "jon",
                    "timeline" : [
                                    { "location" : "HOME", "from" : "2011-02-01 10:45", "to" : "2011-02-01 12:45" },
                                    { "location" : "AWAY", "from" : "2011-02-01 14:45", "to" : "2011-02-01 19:45" }
                                 ]
                },
                {
                    "id"       : "03-45-25-14-11-96",
                    "name"     : "MIKE",
                    "timeline" : [
                                    { "location" : "HOME",    "from" : "2011-02-01 10:45", "to" : "2011-02-01 11:45" },
                                    { "location" : "UNKNOWN", "from" : "2011-02-01 12:45", "to" : "2011-02-01 13:45" },
                                    { "location" : "AWAY",    "from" : "2011-02-01 13:45", "to" : "2011-02-01 23:59" }
                                 ]
                },
                {
                    "id"       : "03-45-25-14-11-96",
                    "name"     : "Paul",
                    "timeline" : [
                                    { "location" : "HOME", "from" : "2011-02-01 10:45", "to" : "2011-02-01 23:45" }
                                 ]
                },
                {
                    "id"       : "03-45-25-14-11-96",
                    "name"     : "Sue",
                    "timeline" : [
                                    { "location" : "HOME", "from" : "2011-02-01 00:00", "to" : "2011-02-01 10:45" },
                                    { "location" : "AWAY", "from" : "2011-02-01 14:45", "to" : "2011-02-01 23:59" }
                                 ]
                }
            ]
}
        </p>
    </div>

    <div class="errors">
        <h3>Returned errors:</h3>
        <dl>
            <dt>400 MISSING_PARAMETER</dt>  <dd>One of :year, :month, :day is missing from request</dd>
            <dt>400 INVALID_PARAMETER</dt>  <dd>One of :year, :month, :day is invalid</dd>
            <dt>404 NO_DATA</dt>  <dd>There was no stored data to return in the request period specified.</dd>
        </dl>
    </div>
</div>
    </div>
  </body>

<!-- Mirrored from api.irissmarttest.com/v5/docs/calls/widgets/presence by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 18 Feb 2014 21:37:15 GMT -->
</html>
